<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>JSONAPI Suite</title>
  <meta name="description" content="Collection of Ruby libraries for powering JSONAPI-compliant APIs.">

  <link rel="stylesheet" href="/jsonapi_suite/assets/main.css?ref=wh4t3v45">
  <link rel="alternate" type="application/rss+xml" title="JSONAPI Suite" href="/jsonapi_suite/feed.xml">

  <!-- javascript -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

  
</head>


  <body>
    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <header class="navbar navbar-inverse normal" role="banner">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a href="/jsonapi_suite/" class="navbar-brand">JSONAPI Suite</a>
    </div>
    <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
      <ul class="nav navbar-nav">
        <li>
          <a class="nav-link" href="/jsonapi_suite/quickstart">Quickstart</a>
        </li>
        <li>
          <a class="nav-link" href="/jsonapi_suite/tutorial">Tutorial</a>
        </li>
        <li>
          <a class="nav-link" href="/jsonapi_suite/concepts">Concepts</a>
        </li>
        <li>
          <a class="nav-link" href="/jsonapi_suite/ruby">Docs</a>
        </li>
        <li>
          <a class="nav-link" href="/jsonapi_suite/js/home">Javascript Client</a>
        </li>
      </ul>
      <ul class="nav navbar-nav navbar-right visible-md visible-lg">
        <li>
          <a href="https://github.com/jsonapi-suite/jsonapi_suite" class="button">Fork on Github</a>
        </li>
      </ul>
    </nav>
  </div>
</header>

        <div id="docs">
  <div id="guide">
    <h1 class="logo">
      <a href="index.html">JSONAPI Suite</a>
    </h1>
    <ul class="menu nav">
      
        <li>
          <a href="#resources">Resources</a>
        </li>
      
        <li>
          <a href="#serializers">Serializers</a>
        </li>
      
        <li>
          <a href="#sideloading">Sideloading</a>
        </li>
      
        <li>
          <a href="#sideposting">Sideposting</a>
        </li>
      
    </ul>
  </div>

  <div id="api-docs">
    <div id="methods">
      
        <div class="method" id="resources">
          <div class="method-section clearfix">
            <div class="method-description">
              <h3>Resources</h3>
              <p>
  <a href="https://jsonapi-suite.github.io/jsonapi_compliable/JsonapiCompliable/Resource.html">Resources</a> are where you define how to query and persist a given <code class="highlighter-rouge">Model</code>.
  We'll wire-up the JSONAPI contract for you, so you can customize hooks rather
  than spend your time parsing query parameters.
</p>

<p>
To the right, you'll see potential overrides of default behavior. Our defaults are based on <code class="highlighter-rouge">ActiveRecord</code>
  and Rails conventions - so customizations like this are often not required.
</p>

<p>
  If you find yourself writing the same customizations over and over again, DRY them up by writing an
  <a href="https://jsonapi-suite.github.io/jsonapi_compliable/JsonapiCompliable/Adapters/Abstract.html">Adapter</a>.
</p>

<p>
  See also:
  <ul>
    <li>
      <a href="/jsonapi_suite/how-to-use-without-activerecord">How to use alternate ORMs</a>
    </li>
    <li>
      <a href="/jsonapi_suite/how-to-build-an-adapter">How to build an Adapter</a>
    </li>
    <li>
      <a href="/jsonapi_suite/how-to-add-defaults">How to add default behavior</a>
    </li>
    <li>
      <a href="/jsonapi_suite/how-to-cause-side-effects">How to cause side-effects</a>
    </li>
  </ul>
</p>

            </div>
            <div class="method-example">

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">PostResource</span> <span class="o">&lt;</span> <span class="no">ApplicationResource</span>
  <span class="c1"># Use default logic (specified in adapter)</span>
  <span class="c1"># when no block passed</span>
  <span class="n">allow_filter</span> <span class="ss">:active</span>

  <span class="n">allow_filter</span> <span class="ss">:title_prefix</span> <span class="k">do</span> <span class="o">|</span><span class="n">scope</span><span class="p">,</span> <span class="n">value</span><span class="o">|</span>
    <span class="c1"># Example:</span>
    <span class="c1"># scope.where(["title LIKE ?", "#{value}%"])</span>
  <span class="k">end</span>

  <span class="n">sort</span> <span class="k">do</span> <span class="o">|</span><span class="n">scope</span><span class="p">,</span> <span class="n">att</span><span class="p">,</span> <span class="n">dir</span><span class="o">|</span>
    <span class="c1"># Example:</span>
    <span class="c1"># scope.order(att =&gt; dir)</span>
  <span class="k">end</span>

  <span class="n">paginate</span> <span class="k">do</span> <span class="o">|</span><span class="n">scope</span><span class="p">,</span> <span class="n">current_page</span><span class="p">,</span> <span class="n">per_page</span><span class="o">|</span>
    <span class="c1"># Example:</span>
    <span class="c1"># scope.per(per_page).page(current_page)</span>
  <span class="k">end</span>

  <span class="c1"># Example: let's say we're hitting an HTTP</span>
  <span class="c1"># service instead of ActiveRecord. Maybe our</span>
  <span class="c1"># scope is a big hash we build up, and now</span>
  <span class="c1"># we need to use a client to take that hash and</span>
  <span class="c1"># execute the HTTP request.</span>
  <span class="k">def</span> <span class="nf">resolve</span><span class="p">(</span><span class="n">scope</span><span class="p">)</span>
    <span class="no">MyHTTPClient</span><span class="p">.</span><span class="nf">request</span><span class="p">(</span><span class="n">scope</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure>


            </div>
          </div>
        </div>
      
        <div class="method" id="serializers">
          <div class="method-section clearfix">
            <div class="method-description">
              <h3>Serializers</h3>
              <p>
  <strong>Serializers</strong> define the structure of the response.
</p>

<p>
  We use <a href="http://jsonapi-rb.org">jsonapi-rb</a> for serialization. If you're familiar
  with <a href="https://github.com/rails-api/active_model_serializers">active_model_serializers</a>,
  the interface will seem very familiar. In fact, jsonapi-rb was created by one of the owners of that
  project.
</p>

<p>
  See also:
  <ul>
    <li>
      <a href="/jsonapi_suite/how-to-conditionally-render-fields">How to Conditionally Render Fields</a>
    </li>
  </ul>
</p>

            </div>
            <div class="method-example">

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">PostSerializer</span> <span class="o">&lt;</span> <span class="no">ApplicationSerializer</span>
  <span class="n">type</span> <span class="s1">'foos'</span>

  <span class="n">attribute</span> <span class="ss">:title</span>

  <span class="n">attribute</span> <span class="ss">:description</span> <span class="k">do</span>
    <span class="vi">@object</span><span class="p">.</span><span class="nf">active?</span> <span class="p">?</span> <span class="s1">'Active Post'</span> <span class="p">:</span> <span class="s1">'Inactive Post'</span>
  <span class="k">end</span>

  <span class="n">extra_attribute</span> <span class="ss">:net_worth</span> <span class="k">do</span>
    <span class="vi">@object</span><span class="p">.</span><span class="nf">assets</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="o">&amp;</span><span class="ss">:value</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="n">has_many</span> <span class="ss">:comments</span> <span class="k">do</span>
    <span class="n">data</span> <span class="k">do</span>
      <span class="vi">@object</span><span class="p">.</span><span class="nf">published_comments</span>
    <span class="k">end</span>

    <span class="n">link</span> <span class="ss">:related</span> <span class="k">do</span>
      <span class="vi">@url_helpers</span><span class="p">.</span><span class="nf">comments_url</span><span class="p">(</span><span class="ss">filter: </span><span class="p">{</span> <span class="ss">post_id: </span><span class="vi">@object</span><span class="p">.</span><span class="nf">id</span> <span class="p">})</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="n">meta</span> <span class="k">do</span>
    <span class="p">{</span> <span class="ss">featured: </span><span class="kp">true</span> <span class="p">}</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure>


            </div>
          </div>
        </div>
      
        <div class="method" id="sideloading">
          <div class="method-section clearfix">
            <div class="method-description">
              <h3>Sideloading</h3>
              <p>
  You're probably already familiar with the concept of "sideloading", documented in
  the
  <a target="_blank" href="http://jsonapi.org/format/#fetching-includes">
    "Inclusion of Related Resources"
  </a>
  section of the JSONPI spec.
</p>

<p>
  If using an
  <a target="_blank" href="https://jsonapi-suite.github.io/jsonapi_compliable/JsonapiCompliable/Adapters/Abstract.html">
    Adapter
  </a>, such as the default
  <code class="highlighter-rouge">ActiveRecord</code> adapter,
  you can do this with simple
  <code class="highlighter-rouge">has_many</code>-style macros.
</p>

<p>
  If not using an adapter, or to implement a one-off customization,
  you can drop down to the lower-level
  <code class="highlighter-rouge">allow_sideload</code> DSL. Adapter
  macros are simply wrapping this DSL.
</p>

<p>
  <code class="highlighter-rouge">allow_sideload</code> specifies two simple
  configuration options:
  <ul>
    <li>
      <strong>scope</strong>: specifies how to build a scope that satisifes the
      association.
    </li>
    <li>
      <strong>assign</strong>: specifies how to associate the resulting records with
      their parent association.
    </li>
  </ul>

  <p>
    You can see the default
    <code class="highlighter-rouge">ActiveRecord</code> implementation on the right.
  </p>
</p>

<p>
  See also:

  <ul>
    <li>
      <a href="/jsonapi_suite/how-to-use-without-activerecord">Use Alternate ORMs</a>
    </li>
    <li>
      <a href="/jsonapi_suite/how-to-build-an-adapter">Build an Adapter</a>
    </li>
  </ul>
</p>

            </div>
            <div class="method-example">

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># Adapter example</span>
<span class="n">has_many</span> <span class="ss">:comments</span><span class="p">,</span>
  <span class="ss">foreign_key: :post_id</span><span class="p">,</span>
  <span class="ss">resource: </span><span class="no">CommentResource</span><span class="p">,</span>
  <span class="ss">scope: </span><span class="o">-&gt;</span> <span class="p">{</span> <span class="no">Comment</span><span class="p">.</span><span class="nf">all</span> <span class="p">}</span> <span class="c1"># base scope, like you'd see in a controller</span>



<span class="c1"># Lower-level customization example</span>
<span class="n">allow_sideload</span> <span class="ss">:blog</span><span class="p">,</span> <span class="ss">resource: </span><span class="no">BlogResource</span> <span class="k">do</span>
  <span class="c1"># Return a scope so further query parameters can be applied</span>
  <span class="c1"># and the Resource logic can be re-used</span>
  <span class="n">scope</span> <span class="k">do</span> <span class="o">|</span><span class="n">posts</span><span class="o">|</span>
    <span class="no">Blog</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="ss">id: </span><span class="n">posts</span><span class="p">.</span><span class="nf">map</span><span class="p">(</span><span class="o">&amp;</span><span class="ss">:blog_id</span><span class="p">))</span>
  <span class="k">end</span>

  <span class="n">assign</span> <span class="k">do</span> <span class="o">|</span><span class="n">posts</span><span class="p">,</span> <span class="n">blogs</span><span class="o">|</span>
    <span class="n">posts</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="nb">p</span><span class="o">|</span>
      <span class="nb">p</span><span class="p">.</span><span class="nf">blog</span> <span class="o">=</span> <span class="n">blogs</span><span class="p">.</span><span class="nf">find</span> <span class="p">{</span> <span class="o">|</span><span class="n">b</span><span class="o">|</span> <span class="n">b</span><span class="p">.</span><span class="nf">id</span> <span class="o">==</span> <span class="nb">p</span><span class="p">.</span><span class="nf">blog_id</span> <span class="p">}</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure>


            </div>
          </div>
        </div>
      
        <div class="method" id="sideposting">
          <div class="method-section clearfix">
            <div class="method-description">
              <h3>Sideposting</h3>
              <p>
  We want to be able to *write* a nested relationship graph.
  You can do this by mirroring the same
  <a href="http://jsonapi.org/format/#fetching-includes">sideloading payload</a>
  you see in read requests. To the right, you'll see we're updating a
  <code class="highlighter-rouge">Post</code>, changing the name of its associated
  <code class="highlighter-rouge">Blog</code>, creating a
  <code class="highlighter-rouge">Tag</code>, deleting one
  <code class="highlighter-rouge">Comment</code>, and disassociating (<code class="highlighter-rouge">null</code> foreign key) a different
  <code class="highlighter-rouge">Comment</code>, all in a single request.
</p>

<p>
  When we send RESTful resources to the server, we typically send a corresponding HTTP verb.
  That's the
  <code class="highlighter-rouge">method</code> section of the payload.
  <code class="highlighter-rouge">method</code> can be either
  <code class="highlighter-rouge">create</code>,
  <code class="highlighter-rouge">update</code>,
  <code class="highlighter-rouge">destroy</code>, or
  <code class="highlighter-rouge">disassociate</code>.
</p>

<p>
  When creating, there is no
  <code class="highlighter-rouge">id</code> to pass. Instead, pass
  <code class="highlighter-rouge">temp-id</code>, a random uuid used to
  link the relevant sections of the payload, and which tells clients how to associate
  their in-memory objects with the
  <code class="highlighter-rouge">id</code>s returned from the server. Clients like
  <a target="_blank" href="https://github.com/jsonapi-suite/jsorm">JSORM</a> will take care of this for you automatically.
</p>

<p>
  When we actually perform these operations, everything will run within a transaction. The
  transaction will be rolled back if an error is raised or the
  <code class="highlighter-rouge">Model</code>s, do not pass validation.
</p>

<p>
  See also:

  <ul>
    <li>
      <a href="/jsonapi_suite/tutorial#association-writes">Tutorial: Association Writes</a>
    </li>
  </ul>
</p>

            </div>
            <div class="method-example">

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="p">{</span>
  <span class="ss">data: </span><span class="p">{</span>
    <span class="ss">type: </span><span class="s1">'posts'</span><span class="p">,</span>
    <span class="ss">id: </span><span class="mi">123</span><span class="p">,</span>
    <span class="ss">attributes: </span><span class="p">{</span> <span class="ss">title: </span><span class="s1">'Updated!'</span> <span class="p">},</span>
    <span class="ss">relationships: </span><span class="p">{</span>
      <span class="ss">blog: </span><span class="p">{</span>
        <span class="ss">data: </span><span class="p">{</span> <span class="ss">type: </span><span class="s1">'blogs'</span><span class="p">,</span> <span class="ss">id: </span><span class="mi">123</span><span class="p">,</span> <span class="ss">method: </span><span class="s1">'update'</span> <span class="p">}</span>
      <span class="p">},</span>
      <span class="ss">tags: </span><span class="p">{</span>
        <span class="ss">data: </span><span class="p">[{</span> <span class="ss">type: </span><span class="s1">'tags'</span><span class="p">,</span> <span class="n">temp</span><span class="o">-</span><span class="ss">id: </span><span class="s1">'s0m3uu1d'</span><span class="p">,</span> <span class="ss">method: </span><span class="s1">'create'</span> <span class="p">}]</span>
      <span class="p">},</span>
      <span class="ss">comments: </span><span class="p">{</span>
        <span class="ss">data: </span><span class="p">[</span>
          <span class="p">{</span> <span class="ss">type: </span><span class="s1">'comments'</span><span class="p">,</span> <span class="ss">id: </span><span class="mi">123</span><span class="p">,</span> <span class="ss">method: </span><span class="s1">'destroy'</span> <span class="p">}</span>
          <span class="p">{</span> <span class="ss">type: </span><span class="s1">'comments'</span><span class="p">,</span> <span class="ss">id: </span><span class="mi">456</span><span class="p">,</span> <span class="ss">method: </span><span class="s1">'disassociate'</span> <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="ss">included: </span><span class="p">[</span>
    <span class="p">{</span> <span class="ss">type: </span><span class="s1">'tags'</span><span class="p">,</span> <span class="n">temp</span><span class="o">-</span><span class="ss">id: </span><span class="s1">'s0m3uu1d'</span><span class="p">,</span> <span class="ss">attributes: </span><span class="p">{</span> <span class="ss">name: </span><span class="s1">'Important'</span> <span class="p">}</span> <span class="p">},</span>
    <span class="p">{</span> <span class="ss">type: </span><span class="s1">'blogs'</span><span class="p">,</span> <span class="ss">id: </span><span class="mi">123</span><span class="p">,</span> <span class="ss">attributes: </span><span class="p">{</span> <span class="ss">name: </span><span class="s1">'Updated!'</span> <span class="p">}</span> <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span></code></pre></figure>


            </div>
          </div>
        </div>
      
    </div>
  </div>
</div>

<script type="text/javascript">
  $(function () {
    window.addEventListener('scroll', function(e) {
      if (window.scrollY > 70) {
        $('#guide').css("margin-top", 0);
      } else {
        $('#guide').css("margin-top", 70+-1*window.scrollY);
      }
    });
  });
</script>

<script type="text/javascript">
$(function () {

  var flipTabs = function() {
    var isTS = true;
    if (localStorage.getItem('js-lang') === 'javascript') {
      isTS = false;
    }

    $('.code-tabs').each(function(index, el) {
      if (isTS) {
        console.log('hiding js');
        $($(el).children()[1]).hide();
        $($(el).children()[0]).show();
      } else {
        console.log('hiding ts');
        $($(el).children()[0]).hide();
        $($(el).children()[1]).show();
      }
    });

    if (isTS) {
      $('.tab.typescript').addClass('active');
      $('.tab.javascript').removeClass('active');
    } else {
      $('.tab.typescript').removeClass('active');
      $('.tab.javascript').addClass('active');
    }
  }

  $('.tab').click(function() {
    console.log('HEREERERE');
    if ($(this).hasClass('typescript')) {
      localStorage.setItem('js-lang', 'typescript');
    } else {
      localStorage.setItem('js-lang', 'javascript');
    }

    flipTabs();
  });

  flipTabs();
})
</script>


      </div>
    </main>
    <div class="main-footer main-footer--dark">
  <div class="container">
    <div class="row">
      <div class="col-sm-4 menu">
        <h3>Overview</h3>
        <ul>
          <li>
            <a href="/jsonapi_suite/quickstart">Quickstart</a>
          </li>
          <li>
            <a href="/jsonapi_suite/tutorial">Tutorial</a>
          </li>
          <li>
            <a href="/jsonapi_suite/concepts">Concepts</a>
          </li>
        </ul>
      </div>
      <div class="col-sm-4 menu">
        <h3>Resources</h3>
        <ul>
          <li>
            <a target="_blank" href="https://jsonapi-suite.github.io/jsonapi_compliable">YARD Documentation</a>
          </li>
          <li>
            <a target="_blank" href="https://join.slack.com/t/jsonapi-suite/shared_invite/enQtMjkyMTA3MDgxNTQzLWVkMDM3NTlmNTIwODY2YWFkMGNiNzUzZGMzOTY3YmNmZjBhYzIyZWZlZTk4YmI1YTI0Y2M0OTZmZGYwN2QxZjg">Slack Chat</a>
          </li>
          <li>
            <a href="mailto:richmolj@gmail.com">Contact us</a>
          </li>
        </ul>
      </div>
      <div class="col-sm-4 menu">
        <h3>Related</h3>
        <ul>
          <li>
            <a target="_blank" href="http://jsonapi.org">JSONAPI Spec</a>
          </li>
          <li>
            <a target="_blank" href="http://jsonapi-rb.org">jsonapi-rb</a>
          </li>
          <li>
            <a target="_blank" href="https://vuejs.org/">VueJS</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>

  </body>
</html>
